<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
</head>
<body>
	<form action="#">
	书名:<input type="text" id="bname"/><hr>
		<!-- <label for="file">图片:</label>
		<input type="file" id="file"/><hr>  -->
	图片:<input type="text" id="pic"/><hr>
	价格:<input type="text" id="price"/><hr>
	时间:<input type="text" id="pubdate"/><hr>
		<input type="button" value="添加" id="btn" />
	</form>


	<script>
		btn.onclick=function(){
			var bn=bname.value;
			var pi=pic.value;
			// var fi=file.value;
			// var i=fi.lastIndexOf(".")-1;
			// 	fi=fi.slice(i);
			var pr=price.value;
			var pu=pubdate.value;
			var xhr=new XMLHttpRequest();
			xhr.onreadystatechange=function(){
				if (xhr.readyState==4 && xhr.status==200){
					console.log(xhr.responseText);
					var num=xhr.responseText|0;
					if(num>0){
						alert("新记录添加成功！"+num);
						bname.value='';
						pic.value='';
						price.value='';
						pubdate.value='';
					}else{
						alert("添加失败，错误代码是："+num);
					}
				}
			}
			xhr.open('POST','add_book.php',true);
			xhr.setRequestHeader('Content-Type','application/x-www-form-urlencoded');
			xhr.send(`bname=${bn}&pic=${pi}&price=${pr}&pubdate=${pu}`);
		}
	</script>
</body>
</html>